# Tita2 åŒè½®è¶³æœºå™¨äººå®Œæ•´æŠ€æœ¯æŒ‡å—

> ç‰ˆæœ¬ï¼š1.0 | æ›´æ–°æ—¥æœŸï¼š2025å¹´11æœˆ28æ—¥

---

## ğŸ“‘ ç›®å½•

1. [é¡¹ç›®æ€»è§ˆ](#1-é¡¹ç›®æ€»è§ˆ)
2. [åŒè½®è¶³ vs å››è¶³é…ç½®è¯¦ç»†å¯¹æ¯”](#2-åŒè½®è¶³-vs-å››è¶³é…ç½®è¯¦ç»†å¯¹æ¯”)
3. [ä» tita_rl å€Ÿé‰´çš„å†…å®¹](#3-ä»-tita_rl-å€Ÿé‰´çš„å†…å®¹)
4. [é¡¹ç›®ä»£ç æ¶æ„è¯¦è§£](#4-é¡¹ç›®ä»£ç æ¶æ„è¯¦è§£)
5. [è®­ç»ƒç¯å¢ƒæ­å»ºæµç¨‹](#5-è®­ç»ƒç¯å¢ƒæ­å»ºæµç¨‹)
6. [æ·»åŠ æ–°åœ°å½¢çš„å®Œæ•´æŒ‡å—](#6-æ·»åŠ æ–°åœ°å½¢çš„å®Œæ•´æŒ‡å—)
7. [è®­ç»ƒæµç¨‹å®Œæ•´é€»è¾‘](#7-è®­ç»ƒæµç¨‹å®Œæ•´é€»è¾‘)
8. [å¸¸è§é—®é¢˜ä¸è°ƒè¯•](#8-å¸¸è§é—®é¢˜ä¸è°ƒè¯•)

---

## 1. é¡¹ç›®æ€»è§ˆ

### 1.1 é¡¹ç›®èƒŒæ™¯

Tita2 æ˜¯ä¸€ä¸ªä¸“ä¸ºåŒè½®è¶³æœºå™¨äººè®¾è®¡çš„å¼ºåŒ–å­¦ä¹ è®­ç»ƒæ¡†æ¶ï¼Œå®ƒèåˆäº†ä¸¤ä¸ªä¼˜ç§€é¡¹ç›®çš„ç²¾åï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Tita2 é¡¹ç›®èµ·æº                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚  extreme_parkour â”‚         â”‚    tita_rl      â”‚              â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚              â”‚
â”‚   â”‚ â€¢ å¤æ‚åœ°å½¢ç”Ÿæˆ   â”‚         â”‚ â€¢ 8DOFåŒè½®è®¾è®¡  â”‚              â”‚
â”‚   â”‚ â€¢ ç›®æ ‡ç‚¹å¯¼èˆª    â”‚    +    â”‚ â€¢ ç®€æ´PDæ§åˆ¶    â”‚              â”‚
â”‚   â”‚ â€¢ è¾¹ç¼˜æ£€æµ‹ç®—æ³•  â”‚         â”‚ â€¢ å…³èŠ‚é‡æ’åº    â”‚              â”‚
â”‚   â”‚ â€¢ è¯¾ç¨‹å­¦ä¹ æ¡†æ¶  â”‚         â”‚ â€¢ ç¨³å®šç«™å§¿é…ç½®  â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚            â”‚                           â”‚                        â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                        â–¼                                        â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚            â”‚       Tita2         â”‚                              â”‚
â”‚            â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                              â”‚
â”‚            â”‚ â€¢ è½®å¼è¾¹ç¼˜æ£€æµ‹ç®—æ³•  â”‚                              â”‚
â”‚            â”‚ â€¢ 8DOFè§‚æµ‹ç©ºé—´é€‚é…  â”‚                              â”‚
â”‚            â”‚ â€¢ Parkouråœ°å½¢è®­ç»ƒ   â”‚                              â”‚
â”‚            â”‚ â€¢ 4096å¹¶è¡Œç¯å¢ƒ     â”‚                              â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Tita2 æœºå™¨äººç‰©ç†å‚æ•°

```
                    Tita2 æœºå™¨äººç»“æ„ç¤ºæ„å›¾
                    
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  BASE   â”‚  â† èº¯å¹² (ç¢°æ’ç»ˆæ­¢)
                         â”‚  LINK   â”‚
                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
        â”‚  LEFT_LEG â”‚                   â”‚ RIGHT_LEG â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚        â”‚        â”‚           â”‚        â”‚        â”‚
   leg_1    leg_2    leg_3       leg_1    leg_2    leg_3
   (é«‹æ¨ªæ»š) (é«‹ä¿¯ä»°)  (è†)        (é«‹æ¨ªæ»š) (é«‹ä¿¯ä»°)  (è†)
     â”‚        â”‚        â”‚           â”‚        â”‚        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
           leg_4                           leg_4
          (è½®å­)                           (è½®å­)
           â—¯                                â—¯
      r=0.0925m                        r=0.0925m


å…³èŠ‚é…ç½®è¡¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å…³èŠ‚åç§°      â”‚ ç±»å‹   â”‚ é»˜è®¤è§’åº¦   â”‚   ä½œç”¨   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ joint_left_leg_1 â”‚ æ—‹è½¬   â”‚   0.0 rad  â”‚ é«‹-æ¨ªæ»š  â”‚
â”‚ joint_left_leg_2 â”‚ æ—‹è½¬   â”‚   0.8 rad  â”‚ é«‹-ä¿¯ä»°  â”‚
â”‚ joint_left_leg_3 â”‚ æ—‹è½¬   â”‚  -1.5 rad  â”‚ è†å…³èŠ‚   â”‚
â”‚ joint_left_leg_4 â”‚ è¿ç»­   â”‚   0.0 rad  â”‚ è½®å­     â”‚
â”‚ joint_right_leg_1â”‚ æ—‹è½¬   â”‚   0.0 rad  â”‚ é«‹-æ¨ªæ»š  â”‚
â”‚ joint_right_leg_2â”‚ æ—‹è½¬   â”‚   0.8 rad  â”‚ é«‹-ä¿¯ä»°  â”‚
â”‚ joint_right_leg_3â”‚ æ—‹è½¬   â”‚  -1.5 rad  â”‚ è†å…³èŠ‚   â”‚
â”‚ joint_right_leg_4â”‚ è¿ç»­   â”‚   0.0 rad  â”‚ è½®å­     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰©ç†å‚æ•°ï¼š
â€¢ è½®å­åŠå¾„ï¼š0.0925 m
â€¢ ç«™ç«‹é«˜åº¦ï¼š0.35 m
â€¢ æœ€å¤§ç”µæœºæ‰­çŸ©ï¼š33.5 NÂ·m
â€¢ æ§åˆ¶é¢‘ç‡ï¼š50 Hz (200Hz / decimation=4)
```

### 1.3 æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹

| ç‰¹æ€§ | è¯´æ˜ | ä¼˜åŠ¿ |
|------|------|------|
| **8DOF é…ç½®** | æ¯è…¿4å…³èŠ‚ï¼ŒåŒè…¿å…±8ä¸ª | æ¯”å››è¶³ç®€åŒ–ï¼Œè¿åŠ¨æ›´çµæ´» |
| **è½®å¼è¾¹ç¼˜æ£€æµ‹** | åœ†å‘¨10ç‚¹é‡‡æ ·ç®—æ³• | é€‚é…è½®å­è¿ç»­æ¥è§¦ç‰¹æ€§ |
| **ç›®æ ‡ç‚¹å¯¼èˆª** | tracking_yaw å¥–åŠ± | å¼•å¯¼æ²¿æœ€ä¼˜è·¯å¾„è¿åŠ¨ |
| **è¯¾ç¨‹å­¦ä¹ ** | 10çº§éš¾åº¦æ¸è¿› | ä»ç®€å•åˆ°å›°éš¾é€æ­¥å­¦ä¹  |
| **4096å¹¶è¡Œ** | GPUæ‰¹é‡ä»¿çœŸ | è®­ç»ƒé€Ÿåº¦ ~2000 FPS |

---

## 2. åŒè½®è¶³ vs å››è¶³é…ç½®è¯¦ç»†å¯¹æ¯”

### 2.1 æ€»ä½“å¯¹æ¯”è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŒè½®è¶³ vs å››è¶³ æ ¸å¿ƒå·®å¼‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    é…ç½®é¡¹      â”‚   å››è¶³ (ANYmal/A1)    â”‚      åŒè½®è¶³ (Tita2)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è‡ªç”±åº¦ (DOF)   â”‚ 12 (4è…¿Ã—3å…³èŠ‚)        â”‚ 8 (2è…¿Ã—4å…³èŠ‚)                 â”‚
â”‚ è¶³ç«¯æ•°é‡       â”‚ 4 ä¸ªç‚¹æ¥è§¦            â”‚ 2 ä¸ªè½®å­ï¼ˆè¿ç»­æ¥è§¦ï¼‰          â”‚
â”‚ æ¥è§¦æ¨¡å¼       â”‚ ç¦»æ•£ç‚¹æ¥è§¦            â”‚ è¿ç»­æ»šåŠ¨æ¥è§¦                  â”‚
â”‚ n_proprio      â”‚ 53                    â”‚ 39                            â”‚
â”‚ num_actions    â”‚ 12                    â”‚ 8                             â”‚
â”‚ contact_buf    â”‚ (N, buf_len, 4)       â”‚ (N, buf_len, 2)               â”‚
â”‚ è¾¹ç¼˜æ£€æµ‹       â”‚ å•ç‚¹æ£€æµ‹              â”‚ åœ†å‘¨é‡‡æ ·æ£€æµ‹                  â”‚
â”‚ ç«™ç«‹é«˜åº¦       â”‚ ~0.5 m                â”‚ 0.35 m                        â”‚
â”‚ è¿åŠ¨ç‰¹ç‚¹       â”‚ æ­¥æ€å‘¨æœŸ              â”‚ è¿ç»­æ»šåŠ¨                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è§‚æµ‹ç©ºé—´ (Observation Space) è¯¦ç»†å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è§‚æµ‹ç©ºé—´ç»´åº¦åˆ†è§£                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  å››è¶³ n_proprio = 53 è®¡ç®—ï¼š                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ang_vel(3) + imu(2) + yaw_related(3) + cmd(3) + flags(2)        â”‚   â”‚
â”‚  â”‚ + dof_pos(12) + dof_vel(12) + actions(12) + contact(4) = 53     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  Tita2 n_proprio = 39 è®¡ç®—ï¼š                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ang_vel(3) + imu(2) + yaw_related(3) + cmd(3) + flags(2)        â”‚   â”‚
â”‚  â”‚ + dof_pos(8) + dof_vel(8) + actions(8) + contact(2) = 39        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  å·®å¼‚æ¥æºï¼šDOFä»12â†’8ï¼Œè¶³ç«¯ä»4â†’2                                         â”‚
â”‚  å·®å€¼ï¼š(12-8)*3 + (4-2) = 12 + 2 = 14 â†’ 53-39=14 âœ“                     â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  æ€»è§‚æµ‹ç©ºé—´ num_observations è®¡ç®—ï¼š                                      â”‚
â”‚                                                                         â”‚
â”‚  å››è¶³ï¼š53 + 132 + 9 + 21 + 53Ã—10 = 745                                  â”‚
â”‚  Tita2ï¼š39 + 187 + 9 + 21 + 39Ã—10 = 646                                 â”‚
â”‚                                                                         â”‚
â”‚  å…¬å¼ï¼šn_proprio + n_scan + n_priv + n_priv_latent + history            â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 è§‚æµ‹ç©ºé—´ç»„æˆè¯¦è§£

```python
# Tita2 è§‚æµ‹å‘é‡æ„æˆ (å…± 646 ç»´)
obs_buf = [
    # === æœ¬ä½“æ„ŸçŸ¥ (n_proprio = 39) ===
    base_ang_vel,           # [3]  è§’é€Ÿåº¦ (IMU)
    imu_obs,                # [2]  roll, pitch
    0*delta_yaw,            # [1]  å ä½ï¼ˆå†å²å…¼å®¹ï¼‰
    delta_yaw,              # [1]  ä¸ç›®æ ‡ç‚¹çš„èˆªå‘å·®
    delta_next_yaw,         # [1]  ä¸ä¸‹ä¸€ç›®æ ‡çš„èˆªå‘å·®
    0*commands[:, 0:2],     # [2]  å ä½
    commands[:, 0:1],       # [1]  å‰è¿›é€Ÿåº¦æŒ‡ä»¤
    env_class_flags,        # [2]  ç¯å¢ƒç±»åˆ«æ ‡å¿—
    dof_pos,                # [8]  å…³èŠ‚ä½ç½® (8 DOF)
    dof_vel,                # [8]  å…³èŠ‚é€Ÿåº¦ (8 DOF)
    last_actions,           # [8]  ä¸Šä¸€æ­¥åŠ¨ä½œ (8 DOF)
    contact_filt,           # [2]  è¶³ç«¯æ¥è§¦çŠ¶æ€ (2 è½®)
    
    # === åœ°å½¢æ‰«æ (n_scan = 187) ===
    heights,                # [187] 17Ã—11 é«˜åº¦æµ‹é‡ç‚¹
    
    # === æ˜¾å¼ç‰¹æƒä¿¡æ¯ (n_priv = 9) ===
    base_lin_vel,           # [3]  åŸºåº§çº¿é€Ÿåº¦
    zeros,                  # [3]  å ä½
    zeros,                  # [3]  å ä½
    
    # === éšå¼ç‰¹æƒä¿¡æ¯ (n_priv_latent = 21) ===
    mass_params,            # [4]  è´¨é‡å‚æ•°
    friction_coeff,         # [1]  æ‘©æ“¦ç³»æ•°
    motor_strength_0,       # [8]  ç”µæœºå¼ºåº¦åç§»1
    motor_strength_1,       # [8]  ç”µæœºå¼ºåº¦åç§»2
    
    # === å†å²è§‚æµ‹ (history_len Ã— n_proprio = 390) ===
    obs_history_buf,        # [10Ã—39] è¿‡å»10æ­¥çš„æœ¬ä½“æ„ŸçŸ¥
]
```

### 2.4 è¾¹ç¼˜æ£€æµ‹ç®—æ³•å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è¾¹ç¼˜æ£€æµ‹ç®—æ³•å¯¹æ¯”                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  å››è¶³æœºå™¨äºº - å•ç‚¹æ£€æµ‹ï¼š                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚       â”Œâ”€â”€â”€â”                                                             â”‚
â”‚       â”‚ â— â”‚  â† è¶³ç«¯ä¸­å¿ƒç‚¹                                               â”‚
â”‚       â””â”€â”€â”€â”˜                                                             â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚    æŸ¥è¯¢ x_edge_mask[foot_x, foot_y]                                     â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚    è¿”å› True/False (å•ä¸ªå¸ƒå°”å€¼)                                          â”‚
â”‚                                                                         â”‚
â”‚  é€‚ç”¨åœºæ™¯ï¼šç‚¹æ¥è§¦ï¼Œè¶³ç«¯è½åœ°é¢ç§¯å°                                         â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  åŒè½®è¶³æœºå™¨äºº - åœ†å‘¨é‡‡æ ·æ£€æµ‹ï¼š                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚
â”‚                                                                         â”‚
â”‚           2  3  4                                                       â”‚
â”‚         â—  â—  â—                                                        â”‚
â”‚       1 â—     â— 5     â† è½®å­åœ†å‘¨ 10 ä¸ªé‡‡æ ·ç‚¹                            â”‚
â”‚         â—  â—  â—          (r = 0.0925m)                                 â”‚
â”‚           0  9  8                                                       â”‚
â”‚             7  6                                                        â”‚
â”‚                                                                         â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚    for i in range(10):                                                  â”‚
â”‚        sample_pos = center + r * [cos(Î¸), sin(Î¸)]                       â”‚
â”‚        at_edge[i] = x_edge_mask[sample_x, sample_y]                     â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚    edge_count = sum(at_edge)                                            â”‚
â”‚    is_danger = edge_count > 10 * 0.4  # è¶…è¿‡40%åœ¨è¾¹ç¼˜                   â”‚
â”‚                                                                         â”‚
â”‚  é€‚ç”¨åœºæ™¯ï¼šè¿ç»­æ¥è§¦ï¼Œè½®å­æ¥è§¦é¢æ˜¯å¼§çº¿                                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.5 å…³èŠ‚ç´¢å¼•é‡æ’åº (reindex ä¾æ®è¯¦è§£)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å…³èŠ‚é‡æ’åº (reindex) è¯¦ç»†è¯´æ˜                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â–¶ é—®é¢˜æ¥æºï¼šURDF å®šä¹‰é¡ºåº â‰  çœŸå®æœºå™¨äººæ§åˆ¶å™¨æœŸæœ›é¡ºåº                   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ ä¾æ®æ¥æºï¼štita_rl é¡¹ç›®çš„ sim2real éƒ¨ç½²ç»éªŒ                           â”‚
â”‚    æ–‡ä»¶ï¼štita_rl/envs/legged_robot.py                                   â”‚
â”‚    æ³¨é‡Šï¼š#sim2real purpose                                              â”‚
â”‚                                                                         â”‚
â”‚  â–¶ URDF æ–‡ä»¶å®šä¹‰é¡ºåº (tita_description.urdf)ï¼š                          â”‚
â”‚    å…ˆå®šä¹‰å·¦è…¿å…³èŠ‚ï¼Œå†å®šä¹‰å³è…¿å…³èŠ‚                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚ <joint name="joint_left_leg_1" ...>   â†’ Isaac Gym ç´¢å¼• [0]  â”‚      â”‚
â”‚    â”‚ <joint name="joint_left_leg_2" ...>   â†’ Isaac Gym ç´¢å¼• [1]  â”‚      â”‚
â”‚    â”‚ <joint name="joint_left_leg_3" ...>   â†’ Isaac Gym ç´¢å¼• [2]  â”‚      â”‚
â”‚    â”‚ <joint name="joint_left_leg_4" ...>   â†’ Isaac Gym ç´¢å¼• [3]  â”‚      â”‚
â”‚    â”‚ <joint name="joint_right_leg_1" ...>  â†’ Isaac Gym ç´¢å¼• [4]  â”‚      â”‚
â”‚    â”‚ <joint name="joint_right_leg_2" ...>  â†’ Isaac Gym ç´¢å¼• [5]  â”‚      â”‚
â”‚    â”‚ <joint name="joint_right_leg_3" ...>  â†’ Isaac Gym ç´¢å¼• [6]  â”‚      â”‚
â”‚    â”‚ <joint name="joint_right_leg_4" ...>  â†’ Isaac Gym ç´¢å¼• [7]  â”‚      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                         â”‚
â”‚  â–¶ DDT çœŸå®æœºå™¨äººæ§åˆ¶å™¨æœŸæœ›é¡ºåºï¼š                                        â”‚
â”‚    DDT Robotics çš„ TITA æœºå™¨äºº SDK é‡‡ç”¨ï¼šå³è…¿åœ¨å‰ï¼Œå·¦è…¿åœ¨å              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [0]: right_leg_1  (å³é«‹æ¨ªæ»š)                      â”‚      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [1]: right_leg_2  (å³é«‹ä¿¯ä»°)                      â”‚      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [2]: right_leg_3  (å³è†)                          â”‚      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [3]: right_leg_4  (å³è½®)                          â”‚      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [4]: left_leg_1   (å·¦é«‹æ¨ªæ»š)                      â”‚      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [5]: left_leg_2   (å·¦é«‹ä¿¯ä»°)                      â”‚      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [6]: left_leg_3   (å·¦è†)                          â”‚      â”‚
â”‚    â”‚ æ§åˆ¶å™¨ç´¢å¼• [7]: left_leg_4   (å·¦è½®)                          â”‚      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                         â”‚
â”‚  â–¶ é‡æ’åºæ˜ å°„å…³ç³»ï¼š                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚    â”‚   ä»¿çœŸ URDF é¡ºåº        â†’      çœŸå®æœºå™¨äººé¡ºåº                â”‚     â”‚
â”‚    â”‚   [0] left_leg_1        â†’      [4] (æ–°ç´¢å¼•)                 â”‚     â”‚
â”‚    â”‚   [1] left_leg_2        â†’      [5]                          â”‚     â”‚
â”‚    â”‚   [2] left_leg_3        â†’      [6]                          â”‚     â”‚
â”‚    â”‚   [3] left_leg_4        â†’      [7]                          â”‚     â”‚
â”‚    â”‚   [4] right_leg_1       â†’      [0] (æ–°ç´¢å¼•)                 â”‚     â”‚
â”‚    â”‚   [5] right_leg_2       â†’      [1]                          â”‚     â”‚
â”‚    â”‚   [6] right_leg_3       â†’      [2]                          â”‚     â”‚
â”‚    â”‚   [7] right_leg_4       â†’      [3]                          â”‚     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                         â”‚
â”‚  â–¶ å®ç°ä»£ç ï¼š                                                            â”‚
â”‚  def reindex(self, tensor):                                             â”‚
â”‚      # sim2real purpose                                                 â”‚
â”‚      # ä» [L1,L2,L3,L4,R1,R2,R3,R4] å˜ä¸º [R1,R2,R3,R4,L1,L2,L3,L4]     â”‚
â”‚      return tensor[:, [4, 5, 6, 7, 0, 1, 2, 3]]                         â”‚
â”‚                                                                         â”‚
â”‚  â–¶ ä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·åšï¼Ÿ                                                    â”‚
â”‚  1. DDT çœŸæœº SDK çš„å…³èŠ‚æ•°ç»„é¡ºåºæ˜¯å›ºå®šçš„ï¼ˆå³è…¿åœ¨å‰ï¼‰                      â”‚
â”‚  2. URDF æŒ‰ç…§ç‰©ç†ç»“æ„å…ˆå®šä¹‰å·¦è…¿å†å®šä¹‰å³è…¿                                â”‚
â”‚  3. å¦‚æœä¸é‡æ’ï¼Œéƒ¨ç½²æ—¶å·¦å³è…¿åŠ¨ä½œä¼šåè¿‡æ¥                                 â”‚
â”‚  4. tita_rl å·²éªŒè¯æ­¤æ˜ å°„å¯æ­£ç¡®éƒ¨ç½²åˆ°çœŸå® TITA æœºå™¨äºº                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ä» tita_rl å€Ÿé‰´çš„å†…å®¹

### 3.1 å€Ÿé‰´å†…å®¹æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä» tita_rl å€Ÿé‰´çš„æ ¸å¿ƒè®¾è®¡                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   tita_rl åŸå§‹è®¾è®¡               Tita2 ä¸­çš„åº”ç”¨                          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 1. 8DOFå…³èŠ‚é…ç½® â”‚    â†’      â”‚ num_actions = 8                 â”‚    â”‚
â”‚   â”‚    æ¯è…¿4å…³èŠ‚    â”‚           â”‚ n_proprio è®¡ç®—åŸºäº8ä¸ªå…³èŠ‚        â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 2. ç»Ÿä¸€PDå‚æ•°   â”‚    â†’      â”‚ stiffness = {'joint': 40.0}     â”‚    â”‚
â”‚   â”‚    ç®€åŒ–è°ƒè¯•     â”‚           â”‚ damping = {'joint': 1.0}        â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 3. é»˜è®¤ç«™å§¿     â”‚    â†’      â”‚ leg_1=0, leg_2=0.8, leg_3=-1.5  â”‚    â”‚
â”‚   â”‚    ç¨³å®šé…ç½®     â”‚           â”‚ leg_4=0 (è½®å­è‡ªç”±)              â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 4. å…³èŠ‚é‡æ’åº   â”‚    â†’      â”‚ reindex(): å·¦å³è…¿é¡ºåºäº¤æ¢       â”‚    â”‚
â”‚   â”‚    é€‚é…çœŸæœº     â”‚           â”‚ [4,5,6,7,0,1,2,3]               â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 5. è½®å¼æ¥è§¦æ¨¡å‹ â”‚    â†’      â”‚ åœ†å‘¨é‡‡æ ·è¾¹ç¼˜æ£€æµ‹ç®—æ³•            â”‚    â”‚
â”‚   â”‚    è€ƒè™‘è½®å­åŠå¾„ â”‚           â”‚ wheel_radius = 0.0925m          â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 é»˜è®¤å…³èŠ‚è§’åº¦é…ç½®è¯¦è§£

```python
# æ¥æºï¼štita_rl çš„ç¨³å®šç«™å§¿é…ç½®
default_joint_angles = {
    'joint_left_leg_1': 0.0,      # é«‹-æ¨ªæ»šï¼šä¿æŒæ°´å¹³
    'joint_left_leg_2': 0.8,      # é«‹-ä¿¯ä»°ï¼šçº¦46Â°å‰å€¾
    'joint_left_leg_3': -1.5,     # è†å…³èŠ‚ï¼šçº¦-86Â°å¼¯æ›²
    'joint_left_leg_4': 0.0,      # è½®å­ï¼šè‡ªç”±è½¬åŠ¨
    'joint_right_leg_1': 0.0,     # é•œåƒé…ç½®
    'joint_right_leg_2': 0.8,
    'joint_right_leg_3': -1.5,
    'joint_right_leg_4': 0.0,
}
```

### 3.3 PD æ§åˆ¶å‚æ•°

```python
# ç®€åŒ–çš„ç»Ÿä¸€å‚æ•°
stiffness = {'joint': 40.0}  # Kp
damping = {'joint': 1.0}     # Kd

# æ§åˆ¶å…¬å¼
torque = Kp Ã— (target - current) - Kd Ã— velocity
```

---

## 4. é¡¹ç›®ä»£ç æ¶æ„è¯¦è§£

### 4.1 é¡¹ç›®ç›®å½•ç»“æ„

```
extreme_parkour/
â”œâ”€â”€ TITA2_COMPLETE_GUIDE.md          # æœ¬æ–‡æ¡£
â”œâ”€â”€ extreme-parkour/
â”‚   â””â”€â”€ legged_gym/
â”‚       â”œâ”€â”€ legged_gym/
â”‚       â”‚   â”œâ”€â”€ envs/                 # ç¯å¢ƒå®šä¹‰
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py       # ä»»åŠ¡æ³¨å†Œ
â”‚       â”‚   â”‚   â”œâ”€â”€ base/
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ legged_robot.py        # åŸºç±»ç¯å¢ƒ
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ legged_robot_config.py # åŸºç±»é…ç½®
â”‚       â”‚   â”‚   â””â”€â”€ tita2/
â”‚       â”‚   â”‚       â”œâ”€â”€ tita2_robot.py         # Tita2ç¯å¢ƒ â­
â”‚       â”‚   â”‚       â””â”€â”€ tita2_config.py        # Tita2é…ç½® â­
â”‚       â”‚   â”œâ”€â”€ scripts/
â”‚       â”‚   â”‚   â”œâ”€â”€ train.py          # è®­ç»ƒè„šæœ¬
â”‚       â”‚   â”‚   â””â”€â”€ play.py           # æµ‹è¯•è„šæœ¬
â”‚       â”‚   â””â”€â”€ utils/
â”‚       â”‚       â”œâ”€â”€ terrain.py        # åœ°å½¢ç”Ÿæˆ â­
â”‚       â”‚       â”œâ”€â”€ task_registry.py  # ä»»åŠ¡æ³¨å†Œå™¨
â”‚       â”‚       â””â”€â”€ helpers.py        # è¾…åŠ©å‡½æ•°
â”‚       â””â”€â”€ resources/
â”‚           â””â”€â”€ robots/
â”‚               â””â”€â”€ tita/
â”‚                   â””â”€â”€ urdf/
â”‚                       â””â”€â”€ tita_description.urdf  # æœºå™¨äººURDF
â””â”€â”€ tita_rl/                          # å‚è€ƒé¡¹ç›®
```

### 4.2 ç±»ç»§æ‰¿å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç±»ç»§æ‰¿å…³ç³»å›¾                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚                        BaseTask                                          â”‚
â”‚                      (rsl_rlåŸºç±»)                                        â”‚
â”‚                           â”‚                                              â”‚
â”‚                           â”‚ æä¾›: reset(), step(), compute_reward()     â”‚
â”‚                           â–¼                                              â”‚
â”‚                     LeggedRobot                                          â”‚
â”‚               (extreme_parkouråŸºç±»)                                      â”‚
â”‚                           â”‚                                              â”‚
â”‚                           â”‚ æä¾›: åœ°å½¢ã€è§‚æµ‹ã€å¥–åŠ±ã€ç›®æ ‡å¯¼èˆª              â”‚
â”‚                           â”‚       è¾¹ç¼˜æ£€æµ‹ã€è¯¾ç¨‹å­¦ä¹                       â”‚
â”‚                           â–¼                                              â”‚
â”‚                      Tita2Robot                                          â”‚
â”‚                    (æˆ‘ä»¬çš„å®ç°)                                          â”‚
â”‚                           â”‚                                              â”‚
â”‚                           â”‚ è¦†ç›–: _create_envs()                         â”‚
â”‚                           â”‚       _init_buffers()                        â”‚
â”‚                           â”‚       reindex()                              â”‚
â”‚                           â”‚       _reward_feet_edge()                    â”‚
â”‚                           â–¼                                              â”‚
â”‚                   å®ä¾‹åŒ–å¯¹è±¡                                             â”‚
â”‚              (4096ä¸ªå¹¶è¡Œä»¿çœŸç¯å¢ƒ)                                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 é…ç½®ç±»ç»§æ‰¿å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       é…ç½®ç±»ç»§æ‰¿å…³ç³»                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   LeggedRobotCfg (åŸºç±»)                                                 â”‚
â”‚   â”œâ”€â”€ class env:        åŸºç¡€ç¯å¢ƒå‚æ•°                                    â”‚
â”‚   â”œâ”€â”€ class terrain:    åœ°å½¢å‚æ•°                                        â”‚
â”‚   â”œâ”€â”€ class commands:   æŒ‡ä»¤å‚æ•°                                        â”‚
â”‚   â”œâ”€â”€ class init_state: åˆå§‹çŠ¶æ€                                        â”‚
â”‚   â”œâ”€â”€ class control:    æ§åˆ¶å‚æ•°                                        â”‚
â”‚   â”œâ”€â”€ class asset:      èµ„äº§å‚æ•°                                        â”‚
â”‚   â”œâ”€â”€ class domain_rand:åŸŸéšæœºåŒ–                                        â”‚
â”‚   â”œâ”€â”€ class rewards:    å¥–åŠ±å‚æ•°                                        â”‚
â”‚   â””â”€â”€ ...                                                               â”‚
â”‚         â”‚                                                               â”‚
â”‚         â”‚ ç»§æ‰¿å¹¶è¦†ç›–                                                    â”‚
â”‚         â–¼                                                               â”‚
â”‚   Tita2Cfg (æ´¾ç”Ÿç±»)                                                     â”‚
â”‚   â”œâ”€â”€ class env:        n_proprio=39, num_actions=8                     â”‚
â”‚   â”œâ”€â”€ class terrain:    parkouråœ°å½¢é…ç½®                                 â”‚
â”‚   â”œâ”€â”€ class init_state: Tita2é»˜è®¤ç«™å§¿                                   â”‚
â”‚   â”œâ”€â”€ class control:    ç»Ÿä¸€PDå‚æ•°                                      â”‚
â”‚   â”œâ”€â”€ class asset:      Tita2 URDFè·¯å¾„                                  â”‚
â”‚   â”œâ”€â”€ class domain_rand:Tita2åŸŸéšæœºåŒ–                                   â”‚
â”‚   â””â”€â”€ class rewards:    å¯ç”¨feet_edgeç­‰                                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 æ ¸å¿ƒæ–‡ä»¶åŠŸèƒ½è¯´æ˜

| æ–‡ä»¶ | è¡Œæ•° | ä¸»è¦åŠŸèƒ½ |
|------|------|----------|
| `tita2_robot.py` | ~420 | ç¯å¢ƒç±»å®ç°ï¼šåˆ›å»ºç¯å¢ƒã€åˆå§‹åŒ–ç¼“å†²åŒºã€é‡æ’åºã€è¾¹ç¼˜æ£€æµ‹ |
| `tita2_config.py` | ~295 | é…ç½®ç±»ï¼šè§‚æµ‹ç©ºé—´ã€å¥–åŠ±ã€åœ°å½¢ã€PDå‚æ•°ç­‰ |
| `legged_robot.py` | ~1287 | åŸºç±»ï¼šä»¿çœŸå¾ªç¯ã€è§‚æµ‹è®¡ç®—ã€å¥–åŠ±å‡½æ•°ã€ç›®æ ‡å¯¼èˆª |
| `terrain.py` | ~943 | åœ°å½¢ç”Ÿæˆï¼š20+ç§åœ°å½¢ç±»å‹ã€è¾¹ç¼˜æ©ç ç”Ÿæˆ |
| `task_registry.py` | ~100 | ä»»åŠ¡æ³¨å†Œï¼šç®¡ç†æ‰€æœ‰å¯ç”¨ç¯å¢ƒ |

---

## 5. è®­ç»ƒç¯å¢ƒæ­å»ºæµç¨‹

### 5.1 ç¯å¢ƒåˆ›å»ºå®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è®­ç»ƒç¯å¢ƒåˆ›å»ºå®Œæ•´æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚ 1. å¯åŠ¨è®­ç»ƒ â”‚  python train.py --task=tita2                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2. ä»»åŠ¡æ³¨å†Œ (task_registry)                                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ æŸ¥æ‰¾ "tita2" ä»»åŠ¡                                          â”‚   â”‚
â”‚  â”‚    â”œâ”€ è·å– Tita2Robot ç±»                                          â”‚   â”‚
â”‚  â”‚    â”œâ”€ è·å– Tita2Cfg é…ç½®                                          â”‚   â”‚
â”‚  â”‚    â””â”€ è·å– Tita2CfgPPO è®­ç»ƒé…ç½®                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 3. Isaac Gym åˆå§‹åŒ–                                              â”‚   â”‚
â”‚  â”‚    â”œâ”€ åˆ›å»º sim (GPUç‰©ç†ä»¿çœŸ)                                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ è®¾ç½®ä»¿çœŸå‚æ•° (dt, substeps, gravity)                       â”‚   â”‚
â”‚  â”‚    â””â”€ åˆå§‹åŒ–æ¸²æŸ“ (headlessæ¨¡å¼å¯é€‰)                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 4. åœ°å½¢ç”Ÿæˆ (Terrain.__init__)                                   â”‚   â”‚
â”‚  â”‚    â”œâ”€ è§£æ terrain_dict é…ç½®                                     â”‚   â”‚
â”‚  â”‚    â”œâ”€ ç”Ÿæˆ 10Ã—15 ä¸ªå­åœ°å½¢ (num_rows Ã— num_cols)                  â”‚   â”‚
â”‚  â”‚    â”œâ”€ åˆ›å»ºé«˜åº¦åœº height_field_raw                                â”‚   â”‚
â”‚  â”‚    â”œâ”€ ç”Ÿæˆè¾¹ç¼˜æ©ç  x_edge_mask                                   â”‚   â”‚
â”‚  â”‚    â”œâ”€ è½¬æ¢ä¸ºä¸‰è§’ç½‘æ ¼ (trimesh)                                    â”‚   â”‚
â”‚  â”‚    â””â”€ è®¡ç®—ç›®æ ‡ç‚¹ goals                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 5. åˆ›å»ºç¯å¢ƒ (Tita2Robot._create_envs)                            â”‚   â”‚
â”‚  â”‚    â”œâ”€ åŠ è½½ URDF æ–‡ä»¶                                              â”‚   â”‚
â”‚  â”‚    â”œâ”€ è®¾ç½®å…³èŠ‚ PD å‚æ•°                                            â”‚   â”‚
â”‚  â”‚    â”œâ”€ åˆ›å»º 4096 ä¸ªå¹¶è¡Œç¯å¢ƒ                                        â”‚   â”‚
â”‚  â”‚    â”œâ”€ è®¾ç½®è¶³ç«¯ç´¢å¼• feet_indices                                   â”‚   â”‚
â”‚  â”‚    â”œâ”€ è®¾ç½®é«‹å…³èŠ‚ç´¢å¼• hip_indices                                  â”‚   â”‚
â”‚  â”‚    â””â”€ è®¾ç½®è½®å­å‚æ•° wheel_radius                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 6. åˆå§‹åŒ–ç¼“å†²åŒº (Tita2Robot._init_buffers)                       â”‚   â”‚
â”‚  â”‚    â”œâ”€ è·å– GPU çŠ¶æ€å¼ é‡                                           â”‚   â”‚
â”‚  â”‚    â”‚   â”œâ”€ root_states: åŸºåº§çŠ¶æ€                                   â”‚   â”‚
â”‚  â”‚    â”‚   â”œâ”€ dof_state: å…³èŠ‚çŠ¶æ€                                     â”‚   â”‚
â”‚  â”‚    â”‚   â”œâ”€ contact_forces: æ¥è§¦åŠ›                                  â”‚   â”‚
â”‚  â”‚    â”‚   â””â”€ rigid_body_states: åˆšä½“çŠ¶æ€                             â”‚   â”‚
â”‚  â”‚    â”œâ”€ åˆå§‹åŒ–è§‚æµ‹å†å² obs_history_buf                              â”‚   â”‚
â”‚  â”‚    â”œâ”€ åˆå§‹åŒ–æ¥è§¦ç¼“å†² contact_buf                                  â”‚   â”‚
â”‚  â”‚    â””â”€ è®¾ç½® PD gains                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚ 7. å¼€å§‹è®­ç»ƒ â”‚  ç¯å¢ƒå‡†å¤‡å®Œæˆï¼                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 è®­ç»ƒå‘½ä»¤å‚è€ƒ

```bash
# åŸºç¡€è®­ç»ƒ
cd extreme-parkour/legged_gym
python legged_gym/scripts/train.py --task=tita2 --headless

# å®Œæ•´å‚æ•°
python legged_gym/scripts/train.py \
    --task=tita2 \
    --sim_device=cuda:0 \
    --rl_device=cuda:0 \
    --num_envs=4096 \
    --headless \
    --max_iterations=15000

# æµ‹è¯•/å¯è§†åŒ–
python legged_gym/scripts/play.py \
    --task=tita2 \
    --load_run=<run_name> \
    --checkpoint=<iteration>
```

---

## 6. æ·»åŠ æ–°åœ°å½¢çš„å®Œæ•´æŒ‡å—

### 6.1 åœ°å½¢ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åœ°å½¢ç”Ÿæˆç³»ç»Ÿæ¶æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ terrain_dict â”‚  â†’   â”‚   Terrain    â”‚  â†’   â”‚ height_field â”‚          â”‚
â”‚  â”‚  (é…ç½®æ–‡ä»¶)   â”‚      â”‚   __init__   â”‚      â”‚    _raw      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                     â”‚                     â”‚                   â”‚
â”‚         â–¼                     â–¼                     â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ proportions  â”‚      â”‚ make_terrain â”‚      â”‚  x_edge_mask â”‚          â”‚
â”‚  â”‚  (æ¯”ä¾‹è®¡ç®—)   â”‚      â”‚  (åœ°å½¢ç”Ÿæˆ)   â”‚      â”‚  (è¾¹ç¼˜æ©ç )   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                     â”‚                     â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                               â–¼                                         â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚                      â”‚   trimesh    â”‚                                   â”‚
â”‚                      â”‚ (ä¸‰è§’ç½‘æ ¼)    â”‚                                   â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 æ·»åŠ æ–°åœ°å½¢æ­¥éª¤

#### æ­¥éª¤ 1: åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰åœ°å½¢

```python
# æ–‡ä»¶: tita2_config.py

class terrain(LeggedRobotCfg.terrain):
    terrain_dict = {
        # ç°æœ‰åœ°å½¢...
        "parkour": 0.2,
        "parkour_hurdle": 0.2,
        "parkour_flat": 0.2,
        "parkour_step": 0.2,
        "parkour_gap": 0.2,
        
        # === æ·»åŠ æ–°åœ°å½¢ ===
        "my_new_terrain": 0.1,    # 10% æ¦‚ç‡å‡ºç°
    }
```

#### æ­¥éª¤ 2: å®ç°åœ°å½¢ç”Ÿæˆå‡½æ•°

```python
# æ–‡ä»¶: legged_gym/utils/terrain.py

def my_new_terrain(terrain,
                   platform_len=2.5,
                   platform_height=0.,
                   num_obstacles=8,
                   obstacle_height_range=[0.1, 0.3],
                   pad_width=0.1,
                   pad_height=0.5):
    """
    è‡ªå®šä¹‰åœ°å½¢ç”Ÿæˆå‡½æ•°
    
    Args:
        terrain: SubTerrain å¯¹è±¡
        platform_len: èµ·å§‹å¹³å°é•¿åº¦ [m]
        platform_height: å¹³å°é«˜åº¦ [m]
        num_obstacles: éšœç¢ç‰©æ•°é‡
        obstacle_height_range: éšœç¢ç‰©é«˜åº¦èŒƒå›´ [m]
        pad_width: è¾¹ç•Œå®½åº¦ [m]
        pad_height: è¾¹ç•Œé«˜åº¦ [m]
    """
    # åˆå§‹åŒ–ç›®æ ‡ç‚¹æ•°ç»„
    goals = np.zeros((num_obstacles + 2, 2))
    
    mid_y = terrain.length // 2
    
    # === 1. åˆ›å»ºèµ·å§‹å¹³å° ===
    platform_len_px = round(platform_len / terrain.horizontal_scale)
    terrain.height_field_raw[0:platform_len_px, :] = 0
    goals[0] = [platform_len_px - 1, mid_y]
    
    # === 2. ç”Ÿæˆéšœç¢ç‰© ===
    dis_x = platform_len_px
    for i in range(num_obstacles):
        # éšæœºé—´è·
        gap = np.random.randint(30, 50)
        dis_x += gap
        
        # éšæœºéšœç¢ç‰©é«˜åº¦
        height = np.random.uniform(*obstacle_height_range)
        height_px = round(height / terrain.vertical_scale)
        
        # æ”¾ç½®éšœç¢ç‰©
        obstacle_width = 10
        terrain.height_field_raw[dis_x:dis_x+obstacle_width, :] = height_px
        
        # è®°å½•ç›®æ ‡ç‚¹
        goals[i+1] = [dis_x + obstacle_width//2, mid_y]
    
    # === 3. åˆ›å»ºç»ˆç‚¹å¹³å° ===
    terrain.height_field_raw[dis_x+20:, :] = 0
    goals[-1] = [dis_x + 50, mid_y]
    
    # === 4. æ·»åŠ è¾¹ç•Œ ===
    pad_width_px = int(pad_width / terrain.horizontal_scale)
    pad_height_px = int(pad_height / terrain.vertical_scale)
    terrain.height_field_raw[:, :pad_width_px] = pad_height_px
    terrain.height_field_raw[:, -pad_width_px:] = pad_height_px
    terrain.height_field_raw[:pad_width_px, :] = pad_height_px
    terrain.height_field_raw[-pad_width_px:, :] = pad_height_px
    
    # === 5. ä¿å­˜ç›®æ ‡ç‚¹ ===
    terrain.goals = goals * terrain.horizontal_scale
```

#### æ­¥éª¤ 3: åœ¨ make_terrain ä¸­æ³¨å†Œ

```python
# æ–‡ä»¶: legged_gym/utils/terrain.py
# åœ¨ make_terrain() æ–¹æ³•ä¸­æ·»åŠ 

def make_terrain(self, choice, difficulty):
    # ... ç°æœ‰ä»£ç  ...
    
    elif choice < self.proportions[20]:  # æ–°ç´¢å¼•
        idx = 21
        my_new_terrain(terrain,
                       num_obstacles=self.num_goals - 2,
                       obstacle_height_range=[0.1 + 0.2*difficulty, 
                                              0.2 + 0.3*difficulty])
        self.add_roughness(terrain)
    
    terrain.idx = idx
    return terrain
```

#### æ­¥éª¤ 4: æµ‹è¯•æ–°åœ°å½¢

```bash
# ä¿®æ”¹é…ç½®ä¸ºåªä½¿ç”¨æ–°åœ°å½¢
terrain_dict = {
    "my_new_terrain": 1.0,  # 100%
}

# è¿è¡Œå¯è§†åŒ–æµ‹è¯•
python legged_gym/scripts/play.py --task=tita2
```

### 6.3 ç°æœ‰åœ°å½¢ç±»å‹å‚è€ƒ

| åœ°å½¢ç±»å‹ | ç´¢å¼• | è¯´æ˜ | éš¾åº¦å‚æ•° |
|----------|------|------|----------|
| `parkour` | 15 | ç»¼åˆè·‘é…·ï¼šå€¾æ–œçŸ³å— | stone_len, incline_height |
| `parkour_hurdle` | 16 | è·¨æ éšœç¢ | hurdle_height, x_range |
| `parkour_flat` | 17 | å¹³å¦ç»ƒä¹ åœº | åŒ hurdle ä½† flat=True |
| `parkour_step` | 18 | é˜¶æ¢¯ä¸Šä¸‹ | step_height |
| `parkour_gap` | 19 | æ²Ÿå£‘è·¨è¶Š | gap_size, gap_depth |
| `demo` | 20 | æ¼”ç¤ºç»„åˆ | æ··åˆå¤šç§éšœç¢ |

---

## 7. è®­ç»ƒæµç¨‹å®Œæ•´é€»è¾‘

### 7.1 è®­ç»ƒä¸»å¾ªç¯æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       PPO è®­ç»ƒä¸»å¾ªç¯                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     åˆå§‹åŒ–é˜¶æ®µ                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚
â”‚  â”‚  â”‚ åˆ›å»ºç¯å¢ƒ     â”‚â†’ â”‚ åˆå§‹åŒ–ç­–ç•¥   â”‚â†’ â”‚ åˆå§‹åŒ–ä¼˜åŒ–å™¨  â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ (4096ä¸ª)     â”‚  â”‚ (Actor+Critic)â”‚  â”‚ (Adam)       â”‚           â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ for iteration in range(15000):  # ä¸»è®­ç»ƒå¾ªç¯                    â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â–¼                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ é˜¶æ®µ 1: æ•°æ®æ”¶é›† (24 æ­¥/ç¯å¢ƒ)                            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  for step in range(24):                                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      obs = env.get_observations()     # (4096, 646)      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      actions = policy.act(obs)        # (4096, 8)        â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      next_obs, rewards, dones = env.step(actions)        â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      storage.add(obs, actions, rewards, values, dones)   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â–¼                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ é˜¶æ®µ 2: è®¡ç®—ä¼˜åŠ¿ (GAE-Î»)                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  advantages = compute_gae(                               â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      rewards,                                            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      values,                                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      dones,                                              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      gamma=0.99,                                         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      lam=0.95                                            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  )                                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  returns = advantages + values                           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â–¼                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ é˜¶æ®µ 3: ç­–ç•¥æ›´æ–° (5 epochs Ã— 4 mini-batches)             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  for epoch in range(5):                                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      for batch in mini_batches(4):                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          # è®¡ç®—æŸå¤±                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          policy_loss = PPO_clip_loss(                    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚              old_actions, new_actions,                   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚              advantages, clip=0.2                        â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          )                                               â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          value_loss = MSE(pred_values, returns)          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          entropy_loss = -0.01 * entropy                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          # æ¢¯åº¦æ›´æ–°                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          loss = policy_loss + value_loss + entropy_loss  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚          optimizer.step(loss)                            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚     â”‚                                                            â”‚   â”‚
â”‚  â”‚     â–¼                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ é˜¶æ®µ 4: æ—¥å¿—ä¸ä¿å­˜                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  if iteration % 100 == 0:                                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚      save_checkpoint()                                   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  log_metrics(rewards, episode_length, success_rate)      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å•æ­¥ä»¿çœŸè¯¦ç»†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      env.step(actions) è¯¦ç»†æµç¨‹                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  è¾“å…¥: actions (4096, 8)                                                â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. åŠ¨ä½œé¢„å¤„ç†                                                    â”‚   â”‚
â”‚  â”‚    actions = reindex(actions)     # å…³èŠ‚é‡æ’åº                   â”‚   â”‚
â”‚  â”‚    actions = clip(actions, Â±2.0)  # åŠ¨ä½œè£å‰ª                     â”‚   â”‚
â”‚  â”‚    actions = actions * 0.5        # åŠ¨ä½œç¼©æ”¾                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2. æ‰­çŸ©è®¡ç®— (PD æ§åˆ¶)                                            â”‚   â”‚
â”‚  â”‚    for _ in range(4):  # decimation=4                            â”‚   â”‚
â”‚  â”‚        target_pos = default_pos + actions * action_scale         â”‚   â”‚
â”‚  â”‚        torques = Kp*(target_pos - dof_pos) - Kd*dof_vel          â”‚   â”‚
â”‚  â”‚        torques = clip(torques, Â±33.5)  # ç”µæœºé™åˆ¶                â”‚   â”‚
â”‚  â”‚        gym.set_dof_actuation_force_tensor(torques)               â”‚   â”‚
â”‚  â”‚        gym.simulate()                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 3. çŠ¶æ€æ›´æ–° (post_physics_step)                                  â”‚   â”‚
â”‚  â”‚    gym.refresh_actor_root_state_tensor()                         â”‚   â”‚
â”‚  â”‚    gym.refresh_dof_state_tensor()                                â”‚   â”‚
â”‚  â”‚    gym.refresh_contact_force_tensor()                            â”‚   â”‚
â”‚  â”‚    gym.refresh_rigid_body_state_tensor()                         â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚    base_quat = root_states[:, 3:7]                               â”‚   â”‚
â”‚  â”‚    base_lin_vel = quat_rotate_inverse(base_quat, lin_vel)        â”‚   â”‚
â”‚  â”‚    base_ang_vel = quat_rotate_inverse(base_quat, ang_vel)        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 4. æ¥è§¦æ£€æµ‹                                                      â”‚   â”‚
â”‚  â”‚    contact = norm(contact_forces[:, term_indices]) > threshold    â”‚   â”‚
â”‚  â”‚    reset_buf = timeout | contact_term                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 5. ç›®æ ‡ç‚¹æ›´æ–° (_update_goals)                                    â”‚   â”‚
â”‚  â”‚    distance_to_goal = norm(position - goal_position)             â”‚   â”‚
â”‚  â”‚    if distance_to_goal < 0.8:  # next_goal_threshold             â”‚   â”‚
â”‚  â”‚        reach_goal_timer += 1                                     â”‚   â”‚
â”‚  â”‚        if timer > delay:                                         â”‚   â”‚
â”‚  â”‚            cur_goal_idx += 1  # åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªç›®æ ‡                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚    target_yaw = atan2(goal_y - pos_y, goal_x - pos_x)            â”‚   â”‚
â”‚  â”‚    delta_yaw = target_yaw - current_yaw                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 6. ç»ˆæ­¢æ£€æŸ¥ (check_termination)                                  â”‚   â”‚
â”‚  â”‚    timeout = episode_length > max_length                         â”‚   â”‚
â”‚  â”‚    contact_term = contact_forces[:, term_indices] > threshold    â”‚   â”‚
â”‚  â”‚    reset_buf = timeout | contact_term                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 7. å¥–åŠ±è®¡ç®— (compute_reward)                                     â”‚   â”‚
â”‚  â”‚    è¯¦è§ 7.3 å¥–åŠ±å‡½æ•°åˆ†è§£                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 8. è§‚æµ‹è®¡ç®— (compute_observations)                               â”‚   â”‚
â”‚  â”‚    obs_buf = [proprio, heights, priv, priv_latent, history]      â”‚   â”‚
â”‚  â”‚    è¯¦è§ 2.3 è§‚æµ‹ç©ºé—´ç»„æˆè¯¦è§£                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  è¾“å‡º: obs_buf, rew_buf, reset_buf, extras                              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 å¥–åŠ±å‡½æ•°åˆ†è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Tita2 å¥–åŠ±å‡½æ•°ç³»ç»Ÿ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  æ€»å¥–åŠ± = Î£ (weight_i Ã— reward_i)                                       â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ­£å‘å¥–åŠ± (é¼“åŠ±çš„è¡Œä¸º)                                            â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  tracking_goal_vel (+1.0)                                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚   â”‚
â”‚  â”‚  å…¬å¼: exp(-|cmd_vel - actual_vel|/0.25)                         â”‚   â”‚
â”‚  â”‚  ä½œç”¨: è·Ÿè¸ªé€Ÿåº¦æŒ‡ä»¤                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  tracking_yaw (+1.0)                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚  å…¬å¼: exp(-|target_yaw - current_yaw|)                          â”‚   â”‚
â”‚  â”‚  ä½œç”¨: æœå‘ç›®æ ‡ç‚¹æ–¹å‘                                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è´Ÿå‘å¥–åŠ± (æƒ©ç½šçš„è¡Œä¸º)                                            â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  lin_vel_z (-2.0)                                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚   â”‚
â”‚  â”‚  å…¬å¼: -|base_lin_vel_z|Â²                                        â”‚   â”‚
â”‚  â”‚  ä½œç”¨: æŠ‘åˆ¶å‚ç›´æ–¹å‘é€Ÿåº¦æ³¢åŠ¨                                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ang_vel_xy (-0.05)                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚  å…¬å¼: -|base_ang_vel_x|Â² - |base_ang_vel_y|Â²                    â”‚   â”‚
â”‚  â”‚  ä½œç”¨: æŠ‘åˆ¶ä¾§å‘å’Œä¿¯ä»°è§’é€Ÿåº¦                                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  orientation (-1.0)                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚  å…¬å¼: -|gravity_x|Â² - |gravity_y|Â²                              â”‚   â”‚
â”‚  â”‚  ä½œç”¨: ä¿æŒèº«ä½“ç›´ç«‹                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  torques (-0.0001)                                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£|torque_i|Â²                                             â”‚   â”‚
â”‚  â”‚  ä½œç”¨: å‡å°‘èƒ½é‡æ¶ˆè€—                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  dof_acc (-2.5e-7)                                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£|dof_vel - last_dof_vel|Â²                               â”‚   â”‚
â”‚  â”‚  ä½œç”¨: å¹³æ»‘å…³èŠ‚è¿åŠ¨                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  collision (-1.0)                                                â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£(contact_force > threshold)                             â”‚   â”‚
â”‚  â”‚  ä½œç”¨: é¿å…èº«ä½“ç¢°æ’                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  action_rate (-0.01)                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£|action - last_action|Â²                                 â”‚   â”‚
â”‚  â”‚  ä½œç”¨: å¹³æ»‘åŠ¨ä½œè¾“å‡º                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  delta_torques (-1.0e-7)                                         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£|torque - last_torque|Â²                                 â”‚   â”‚
â”‚  â”‚  ä½œç”¨: å¹³æ»‘æ‰­çŸ©å˜åŒ–                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  dof_error (-0.03)                                               â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£|dof_pos - default_dof_pos|Â²                            â”‚   â”‚
â”‚  â”‚  ä½œç”¨: ä¿æŒé»˜è®¤å§¿æ€                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  hip_pos (-0.5)                                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£|hip_pos - default_hip_pos|Â² (ä»…4ä¸ªé«‹å…³èŠ‚)              â”‚   â”‚
â”‚  â”‚  ä½œç”¨: çº¦æŸé«‹å…³èŠ‚ä½ç½®                                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  feet_edge (-0.5) â­ Tita2 ä¸“ç”¨                                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚  å…¬å¼: -Î£(wheel_at_edge & in_contact)                            â”‚   â”‚
â”‚  â”‚  ä½œç”¨: é¿å…è½®å­è¸©åœ¨è¾¹ç¼˜                                           â”‚   â”‚
â”‚  â”‚  å®ç°: åœ†å‘¨10ç‚¹é‡‡æ ·ï¼Œ>40%åœ¨è¾¹ç¼˜åˆ™æƒ©ç½š                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 è¾¹ç¼˜æ£€æµ‹å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   _reward_feet_edge() æ‰§è¡Œæµç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  è¾“å…¥: rigid_body_states, contact_filt, terrain.x_edge_mask            â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 1: è·å–è½®å­ä¸­å¿ƒä½ç½®                                         â”‚   â”‚
â”‚  â”‚   wheel_center = rigid_body_states[:, feet_indices, :2]          â”‚   â”‚
â”‚  â”‚   # å½¢çŠ¶: (4096, 2, 2) = (ç¯å¢ƒæ•°, è½®å­æ•°, XY)                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 2: ç”Ÿæˆé‡‡æ ·ç‚¹åç§»                                           â”‚   â”‚
â”‚  â”‚   angles = [0Â°, 36Â°, 72Â°, 108Â°, 144Â°, 180Â°, 216Â°, 252Â°, 288Â°, 324Â°]â”‚   â”‚
â”‚  â”‚   offsets = 0.0925m Ã— [cos(Î¸), sin(Î¸)]                           â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚          2  3  4                                                 â”‚   â”‚
â”‚  â”‚        â—  â—  â—                                                  â”‚   â”‚
â”‚  â”‚      1 â—     â— 5                                                â”‚   â”‚
â”‚  â”‚        â—  â—  â—                                                  â”‚   â”‚
â”‚  â”‚          0  9  8                                                 â”‚   â”‚
â”‚  â”‚            7  6                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 3: å¾ªç¯æ£€æµ‹æ¯ä¸ªé‡‡æ ·ç‚¹                                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   edge_count = zeros(4096, 2)                                    â”‚   â”‚
â”‚  â”‚   for i in range(10):                                            â”‚   â”‚
â”‚  â”‚       sample_pos = wheel_center + offsets[i]                     â”‚   â”‚
â”‚  â”‚       grid_x = round((sample_pos_x + border) / scale)            â”‚   â”‚
â”‚  â”‚       grid_y = round((sample_pos_y + border) / scale)            â”‚   â”‚
â”‚  â”‚       at_edge = x_edge_mask[grid_x, grid_y]                      â”‚   â”‚
â”‚  â”‚       edge_count += at_edge.float()                              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   ç¤ºä¾‹ (æŸä¸ªè½®å­):                                               â”‚   â”‚
â”‚  â”‚   é‡‡æ ·ç‚¹: [0,0,1,1,1,0,0,0,0,0]  # 1=åœ¨è¾¹ç¼˜                     â”‚   â”‚
â”‚  â”‚   edge_count = 3                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 4: åˆ¤å®šå±é™©çŠ¶æ€                                             â”‚   â”‚
â”‚  â”‚   threshold = 10 Ã— 0.4 = 4                                       â”‚   â”‚
â”‚  â”‚   is_danger = edge_count > 4                                     â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   edge_count=3 â†’ is_danger=False (å®‰å…¨)                         â”‚   â”‚
â”‚  â”‚   edge_count=5 â†’ is_danger=True  (å±é™©!)                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Step 5: è®¡ç®—æœ€ç»ˆå¥–åŠ± (â˜… å…³é”®ï¼šæ‚¬ç©ºè½®å­ä¸æƒ©ç½š)                    â”‚   â”‚
â”‚  â”‚   feet_at_edge = contact_filt & is_danger                        â”‚   â”‚
â”‚  â”‚   # åªæƒ©ç½š: æ¥è§¦åœ°é¢ AND åœ¨è¾¹ç¼˜                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   reward = -0.5 Ã— sum(feet_at_edge, dim=-1)                      â”‚   â”‚
â”‚  â”‚   # æ¯ä¸ªå±é™©è½®å­æƒ©ç½š 0.5                                         â”‚   â”‚
â”‚  â”‚   # ä¸¤ä¸ªéƒ½å±é™© â†’ -1.0                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚  è¾“å‡º: reward (4096,)                                                   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.5 è½®å­æ‚¬ç©ºæ—¶çš„å¤„ç†é€»è¾‘ â­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è½®å­æ‚¬ç©ºæ—¶çš„å®Œæ•´å¤„ç†æµç¨‹                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â–¶ contact_filt è®¡ç®—æµç¨‹ï¼š                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ # æ–‡ä»¶: legged_robot.py Line 247-249                            â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ # 1. è¯»å–æ¥è§¦åŠ›ä¼ æ„Ÿå™¨æ•°æ®                                        â”‚   â”‚
â”‚  â”‚ contact_forces = gym.refresh_net_contact_force_tensor()          â”‚   â”‚
â”‚  â”‚ # shape: (num_envs, num_bodies, 3) - XYZæ–¹å‘çš„æ¥è§¦åŠ›             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ # 2. è®¡ç®—è¶³ç«¯ï¼ˆè½®å­ï¼‰æ¥è§¦åŠ›èŒƒæ•°                                  â”‚   â”‚
â”‚  â”‚ foot_force = contact_forces[:, feet_indices]  # (N, 2, 3)       â”‚   â”‚
â”‚  â”‚ foot_force_norm = torch.norm(foot_force, dim=-1)  # (N, 2)      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ # 3. åˆ¤æ–­æ˜¯å¦æ¥è§¦åœ°é¢ï¼ˆåŠ› > 2N è®¤ä¸ºæ¥è§¦ï¼‰                        â”‚   â”‚
â”‚  â”‚ contact = foot_force_norm > 2.0  # (N, 2) å¸ƒå°”                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ # 4. æ»¤æ³¢ï¼šå½“å‰å¸§æˆ–ä¸Šä¸€å¸§æœ‰æ¥è§¦éƒ½ç®—æ¥è§¦                          â”‚   â”‚
â”‚  â”‚ contact_filt = contact | last_contacts                           â”‚   â”‚
â”‚  â”‚ last_contacts = contact  # ä¿å­˜å½“å‰å¸§çŠ¶æ€                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ æ‚¬ç©ºåˆ¤å®šçš„å››ç§æƒ…å†µï¼š                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   æƒ…å†µ 1: è½®å­æ‚¬ç©º + è¾¹ç¼˜ä¸Šæ–¹                                    â”‚   â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚
â”‚  â”‚          â—‹  â† è½®å­æ‚¬ç©ºï¼Œæ¥è§¦åŠ› < 2N                              â”‚   â”‚
â”‚  â”‚          â”‚                                                       â”‚   â”‚
â”‚  â”‚      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                                    â”‚   â”‚
â”‚  â”‚          â–² è¾¹ç¼˜                                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   contact_filt = False, is_danger = True                         â”‚   â”‚
â”‚  â”‚   feet_at_edge = False & True = False                            â”‚   â”‚
â”‚  â”‚   â˜… ç»“æœï¼šä¸æƒ©ç½šï¼ï¼ˆè½®å­æ‚¬ç©ºï¼Œæ²¡è¸©åˆ°è¾¹ç¼˜ï¼‰                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   æƒ…å†µ 2: è½®å­æ¥è§¦ + è¸©åœ¨è¾¹ç¼˜                                    â”‚   â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚
â”‚  â”‚          â—‰  â† è½®å­æ¥è§¦åœ°é¢ï¼Œæ¥è§¦åŠ› > 2N                          â”‚   â”‚
â”‚  â”‚      â–ˆâ–ˆâ–ˆâ–ˆâ”‚â–ˆâ–ˆâ–ˆ                                                    â”‚   â”‚
â”‚  â”‚          â–² è¾¹ç¼˜                                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   contact_filt = True, is_danger = True                          â”‚   â”‚
â”‚  â”‚   feet_at_edge = True & True = True                              â”‚   â”‚
â”‚  â”‚   â˜… ç»“æœï¼šæƒ©ç½šï¼ï¼ˆè¿™æ˜¯æœ€å±é™©çš„æƒ…å†µï¼‰                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   æƒ…å†µ 3: è½®å­æ¥è§¦ + å®‰å…¨ä½ç½®                                    â”‚   â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚   â”‚
â”‚  â”‚      â—‰        â† è½®å­åœ¨å¹³å¦åŒºåŸŸ                                   â”‚   â”‚
â”‚  â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   contact_filt = True, is_danger = False                         â”‚   â”‚
â”‚  â”‚   feet_at_edge = True & False = False                            â”‚   â”‚
â”‚  â”‚   â˜… ç»“æœï¼šä¸æƒ©ç½šï¼ï¼ˆæ­£å¸¸è¡Œèµ°çŠ¶æ€ï¼‰                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   æƒ…å†µ 4: è·³è·ƒ/è…¾ç©º                                              â”‚   â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚   â”‚
â”‚  â”‚          â—‹  â—‹    â† ä¸¤ä¸ªè½®å­éƒ½æ‚¬ç©º                                â”‚   â”‚
â”‚  â”‚          â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   contact_filt = [False, False]                                  â”‚   â”‚
â”‚  â”‚   â˜… ç»“æœï¼šä¸æƒ©ç½šï¼ï¼ˆä¸ç®¡ä¸‹æ–¹æ˜¯ä»€ä¹ˆåœ°å½¢ï¼‰                         â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ ä¸ºä»€ä¹ˆæ‚¬ç©ºä¸æƒ©ç½šï¼Ÿ                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. ç‰©ç†åˆç†æ€§ï¼šåªæœ‰è½®å­æ¥è§¦åœ°é¢æ—¶æ‰æœ‰æ‘”å€’é£é™©                    â”‚   â”‚
â”‚  â”‚ 2. é¼“åŠ±è·³è·ƒï¼šå¦‚æœæ‚¬ç©ºä¹Ÿæƒ©ç½šï¼Œæœºå™¨äººä¼šå®³æ€•è·³è¿‡æ²Ÿå£‘                â”‚   â”‚
â”‚  â”‚ 3. è®­ç»ƒç¨³å®šæ€§ï¼šå‡å°‘ä¸å¿…è¦çš„è´Ÿå¥–åŠ±å™ªå£°                            â”‚   â”‚
â”‚  â”‚ 4. çœŸå®éƒ¨ç½²ï¼šæ‚¬ç©ºæ—¶çš„è¾¹ç¼˜æ£€æµ‹æœ¬èº«å°±ä¸å¯é ï¼ˆè·ç¦»è¿œï¼‰              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ contact_filt æ»¤æ³¢çš„ä½œç”¨ï¼š                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ # ä¸ºä»€ä¹ˆç”¨ contact | last_contacts è€Œä¸æ˜¯åªç”¨ contact?          â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ åŸå› ï¼šç‰©ç†ä»¿çœŸæœ‰æŠ–åŠ¨ï¼Œæ¥è§¦åŠ›å¯èƒ½åœ¨ 2N é™„è¿‘æ³¢åŠ¨                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ æ—¶é—´æ­¥    t=0   t=1   t=2   t=3   t=4                            â”‚   â”‚
â”‚  â”‚ contact   âœ“     âœ—     âœ“     âœ“     âœ—                              â”‚   â”‚
â”‚  â”‚ last      âœ—     âœ“     âœ—     âœ“     âœ“                              â”‚   â”‚
â”‚  â”‚ filt      âœ“     âœ“     âœ“     âœ“     âœ“   â† æ›´ç¨³å®šçš„æ¥è§¦åˆ¤æ–­         â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ æ•ˆæœï¼šé¿å…æŠ–åŠ¨å¯¼è‡´çš„è¯¯åˆ¤ï¼ˆè½®å­å®é™…ä¸Šä¸€ç›´åœ¨åœ°é¢ï¼‰                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.6 è¾¹ç¼˜æ£€æµ‹ç®—æ³•çš„æ•°å­¦ç»†èŠ‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åœ†å‘¨é‡‡æ ·è¾¹ç¼˜æ£€æµ‹ç®—æ³•è¯¦è§£                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â–¶ ç®—æ³•å‚æ•°é…ç½®ï¼š                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ wheel_radius = 0.0925 m           # è½®å­åŠå¾„                    â”‚   â”‚
â”‚  â”‚ wheel_edge_sample_points = 10     # é‡‡æ ·ç‚¹æ•°é‡                  â”‚   â”‚
â”‚  â”‚ edge_threshold = 0.4              # å±é™©é˜ˆå€¼æ¯”ä¾‹                â”‚   â”‚
â”‚  â”‚ horizontal_scale = 0.025 m        # åœ°å½¢ç½‘æ ¼åˆ†è¾¨ç‡              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ é‡‡æ ·ç‚¹åæ ‡è®¡ç®—ï¼š                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å¯¹äºç¬¬ i ä¸ªé‡‡æ ·ç‚¹ (i = 0, 1, ..., 9):                           â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚ Î¸_i = 2Ï€ Ã— i / 10                                               â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚ offset_x = wheel_radius Ã— cos(Î¸_i)                               â”‚    â”‚
â”‚  â”‚ offset_y = wheel_radius Ã— sin(Î¸_i)                               â”‚    â”‚                                                                  â”‚    â”‚
â”‚  â”‚   sample_pos_x = wheel_center_x + offset_x                         â”‚    â”‚
â”‚  â”‚   sample_pos_y = wheel_center_y + offset_y                         â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚   ç¤ºä¾‹ï¼ˆè½®å­ä¸­å¿ƒåœ¨ (1.0, 2.0)ï¼ŒåŠå¾„ 0.0925ï¼‰ï¼š                     â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚ i=0:  Î¸=0Â°     â†’ (1.0925, 2.0)                                   â”‚    â”‚
â”‚  â”‚ i=1:  Î¸=36Â°    â†’ (1.0748, 2.0544)                                â”‚    â”‚
â”‚  â”‚ i=2:  Î¸=72Â°    â†’ (1.0286, 2.0880)                                â”‚    â”‚
â”‚  â”‚ i=3:  Î¸=108Â°   â†’ (0.9714, 2.0880)                                â”‚    â”‚
â”‚  â”‚ i=4:  Î¸=144Â°   â†’ (0.9252, 2.0544)                                â”‚    â”‚
â”‚  â”‚ i=5:  Î¸=180Â°   â†’ (0.9075, 2.0)                                   â”‚    â”‚
â”‚  â”‚ i=6:  Î¸=216Â°   â†’ (0.9252, 1.9456)                                â”‚    â”‚
â”‚  â”‚ i=7:  Î¸=252Â°   â†’ (0.9714, 1.9120)                                â”‚    â”‚
â”‚  â”‚ i=8:  Î¸=288Â°   â†’ (1.0286, 1.9120)                                â”‚    â”‚
â”‚  â”‚ i=9:  Î¸=324Â°   â†’ (1.0748, 1.9456)                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ åœ°å½¢ç½‘æ ¼åæ ‡è½¬æ¢ï¼š                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ # ä¸–ç•Œåæ ‡ â†’ ç½‘æ ¼åæ ‡                                            â”‚   â”‚
â”‚  â”‚ grid_x = round((world_x + border_size) / horizontal_scale)       â”‚   â”‚
â”‚  â”‚ grid_y = round((world_y + border_size) / horizontal_scale)       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ # border_size = 20 (é»˜è®¤), horizontal_scale = 0.025              â”‚   â”‚
â”‚  â”‚ # å‡è®¾ world_pos = (1.0925, 2.0)                                 â”‚   â”‚
â”‚  â”‚ grid_x = round((1.0925 + 20) / 0.025) = round(843.7) = 844       â”‚   â”‚
â”‚  â”‚ grid_y = round((2.0 + 20) / 0.025) = round(880) = 880            â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ # æŸ¥è¯¢è¾¹ç¼˜æ©ç                                                    â”‚   â”‚
â”‚  â”‚ at_edge = x_edge_mask[844, 880]  # True/False                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ å±é™©åˆ¤å®šç®—æ³•ï¼š                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ edge_count = sum(at_edge[i] for i in range(10))                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ threshold = 10 Ã— 0.4 = 4                                         â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ is_danger = edge_count > threshold                               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ è§£é‡Šï¼š                                                           â”‚   â”‚
â”‚  â”‚ - å¦‚æœ 10 ä¸ªé‡‡æ ·ç‚¹ä¸­è¶…è¿‡ 4 ä¸ªåœ¨è¾¹ç¼˜ä¸Š                            â”‚   â”‚
â”‚  â”‚ - è¯´æ˜è½®å­æœ‰è¶…è¿‡ 40% çš„æ¥è§¦é¢åœ¨è¾¹ç¼˜                              â”‚   â”‚
â”‚  â”‚ - è¿™æ˜¯ä¸€ä¸ªå±é™©çŠ¶æ€ï¼Œéœ€è¦æƒ©ç½š                                     â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ ä¸ºä»€ä¹ˆé€‰ 40%ï¼Ÿ                                                   â”‚   â”‚
â”‚  â”‚ - å¤ªä½ï¼ˆå¦‚ 10%ï¼‰ï¼šæ­£å¸¸è¡Œèµ°ä¹Ÿå¯èƒ½è§¦å‘                             â”‚   â”‚
â”‚  â”‚ - å¤ªé«˜ï¼ˆå¦‚ 80%ï¼‰ï¼šå·²ç»æ‰ä¸‹å»äº†æ‰è§¦å‘                             â”‚   â”‚
â”‚  â”‚ - 40% æ˜¯ç»éªŒå€¼ï¼Œç»™æœºå™¨äººè¶³å¤Ÿçš„ååº”æ—¶é—´                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â–¶ x_edge_mask çš„ç”Ÿæˆï¼ˆåœ¨ terrain.py ä¸­ï¼‰ï¼š                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ # è¾¹ç¼˜å®šä¹‰ï¼šé«˜åº¦å·® > move_down_threshold çš„ä½ç½®                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ for x in range(width - 1):                                       â”‚   â”‚
â”‚  â”‚     for y in range(length - 1):                                  â”‚   â”‚
â”‚  â”‚         height_diff = abs(heights[x, y] - heights[x+1, y])       â”‚   â”‚
â”‚  â”‚         if height_diff > move_down_threshold:                    â”‚   â”‚
â”‚  â”‚             x_edge_mask[x, y] = True                             â”‚   â”‚
â”‚  â”‚             x_edge_mask[x+1, y] = True                           â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ # move_down_threshold é»˜è®¤ = 0.3 ~ 0.5 m                         â”‚   â”‚
â”‚  â”‚ # å³é«˜åº¦å·®è¶…è¿‡ 30-50cm è¢«è®¤ä¸ºæ˜¯è¾¹ç¼˜                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. å¸¸è§é—®é¢˜ä¸è°ƒè¯•

### 8.1 ç»´åº¦ä¸åŒ¹é…é—®é¢˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¸¸è§ç»´åº¦é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  é”™è¯¯ 1: "mat1 and mat2 shapes cannot be multiplied (4x53 and 39x128)" â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  åŸå› : Estimator ä½¿ç”¨äº†çˆ¶ç±»é»˜è®¤çš„ num_prop=53                           â”‚
â”‚  è§£å†³: åœ¨ Tita2CfgPPO.estimator ä¸­è¦†ç›–                                 â”‚
â”‚                                                                         â”‚
â”‚  class estimator(LeggedRobotCfgPPO.estimator):                          â”‚
â”‚      num_prop = 39   # è¦†ç›–çˆ¶ç±»çš„ 53                                    â”‚
â”‚      num_scan = 187  # è¦†ç›–çˆ¶ç±»çš„ 132                                   â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  é”™è¯¯ 2: "index out of bounds" in hip_pos reward                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  åŸå› : default_dof_pos ç»´åº¦é”™è¯¯ï¼Œéœ€è¦ (1, 8) è€Œä¸æ˜¯ (8,)                â”‚
â”‚  è§£å†³: åœ¨ _create_envs ä¸­æ·»åŠ                                            â”‚
â”‚                                                                         â”‚
â”‚  self.default_dof_pos = self.default_dof_pos.unsqueeze(0)               â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  é”™è¯¯ 3: contact_buf shape mismatch                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  åŸå› : çˆ¶ç±»æŒ‰ 4 ä¸ªè¶³ç«¯åˆå§‹åŒ–ï¼ŒTita2 åªæœ‰ 2 ä¸ª                           â”‚
â”‚  è§£å†³: åœ¨ _init_buffers ä¸­æ­£ç¡®åˆå§‹åŒ–                                    â”‚
â”‚                                                                         â”‚
â”‚  self.contact_buf = torch.zeros(num_envs, buf_len, 2, ...)              â”‚
â”‚  self.feet_air_time = torch.zeros(num_envs, 2, ...)                     â”‚
â”‚  self.last_contacts = torch.zeros(num_envs, 2, ...)                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 è®­ç»ƒè°ƒè¯•æŠ€å·§

```python
# 1. æ‰“å°è§‚æµ‹ç»´åº¦
print(f"obs_buf shape: {self.obs_buf.shape}")  # åº”ä¸º (4096, 646)
print(f"n_proprio: {self.cfg.env.n_proprio}")   # åº”ä¸º 39

# 2. éªŒè¯ç»´åº¦è®¡ç®—
expected = 39 + 187 + 9 + 21 + 39*10  # = 646
actual = self.obs_buf.shape[1]
assert expected == actual, f"Dimension mismatch: {expected} vs {actual}"

# 3. æ£€æŸ¥å¥–åŠ±å€¼èŒƒå›´
for name, reward in self.episode_sums.items():
    print(f"{name}: {reward.mean():.4f}")

# 4. å¯è§†åŒ–è¾¹ç¼˜æ£€æµ‹
if self.viewer:
    for i in range(self.num_envs):
        for foot_idx in range(2):
            if self.feet_at_edge[i, foot_idx]:
                # ç”»çº¢è‰²çƒè¡¨ç¤ºå±é™©
                pos = self.rigid_body_states[i, self.feet_indices[foot_idx], :3]
                self.gym.add_lines(self.viewer, self.envs[i], ...)
```

### 8.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|----------|
| è®­ç»ƒé€Ÿåº¦æ…¢ | ä½¿ç”¨ `--headless` æ¨¡å¼ |
| GPU å†…å­˜ä¸è¶³ | å‡å°‘ `num_envs` (å¦‚ 2048) |
| ç­–ç•¥ä¸æ”¶æ•› | æ£€æŸ¥å¥–åŠ±æƒé‡å¹³è¡¡ |
| è¿‡æ‹Ÿåˆç®€å•åœ°å½¢ | å¢åŠ è¯¾ç¨‹å­¦ä¹ éš¾åº¦æ¢¯åº¦ |

### 8.4 å¿«é€ŸéªŒè¯å‘½ä»¤

```bash
# 1. éªŒè¯ç¯å¢ƒåˆ›å»º
python -c "
from legged_gym.envs import *
from legged_gym.utils.task_registry import task_registry
env, cfg = task_registry.make_env('tita2', args=None)
print(f'âœ“ Environment created: {env.num_envs} envs')
print(f'âœ“ Observation dim: {env.obs_buf.shape[1]}')
print(f'âœ“ Action dim: {env.num_actions}')
"

# 2. å¿«é€Ÿè®­ç»ƒæµ‹è¯• (2æ¬¡è¿­ä»£)
python legged_gym/scripts/train.py \
    --task=tita2 \
    --num_envs=64 \
    --max_iterations=2 \
    --headless

# 3. åŠ è½½å¹¶å¯è§†åŒ–
python legged_gym/scripts/play.py \
    --task=tita2 \
    --load_run=<latest_run>
```

---

## é™„å½• A: å®Œæ•´æ–‡ä»¶æ¸…å•

| æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½ | å…³é”®ä¿®æ”¹ |
|----------|------|----------|
| `envs/tita2/tita2_config.py` | é…ç½®ç±» | n_proprio=39, num_actions=8 |
| `envs/tita2/tita2_robot.py` | ç¯å¢ƒç±» | _create_envs, _reward_feet_edge |
| `envs/__init__.py` | æ³¨å†Œ | task_registry.register("tita2", ...) |
| `utils/terrain.py` | åœ°å½¢ | parkour ç³»åˆ—åœ°å½¢ |
| `resources/robots/tita/urdf/` | URDF | æœºå™¨äººç‰©ç†æ¨¡å‹ |

---

## é™„å½• B: å¿«é€Ÿå‚è€ƒå¡ç‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Tita2 å¿«é€Ÿå‚è€ƒå¡ç‰‡                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DOFæ•°é‡:        8 (æ¯è…¿4å…³èŠ‚)                          â”‚
â”‚ è¶³ç«¯æ•°é‡:       2 (å·¦å³è½®å­)                           â”‚
â”‚ è½®å­åŠå¾„:       0.0925 m                               â”‚
â”‚ ç«™ç«‹é«˜åº¦:       0.35 m                                 â”‚
â”‚ n_proprio:      39                                     â”‚
â”‚ n_scan:         187 (17Ã—11)                            â”‚
â”‚ num_observations: 646                                  â”‚
â”‚ æ§åˆ¶é¢‘ç‡:       50 Hz                                  â”‚
â”‚ å¹¶è¡Œç¯å¢ƒ:       4096                                   â”‚
â”‚ æœ€å¤§è¿­ä»£:       15000                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…³é”®å¥–åŠ±:                                              â”‚
â”‚   tracking_goal_vel: +1.0                              â”‚
â”‚   tracking_yaw:      +1.0                              â”‚
â”‚   feet_edge:         -0.5 (è½®å¼ä¸“ç”¨)                   â”‚
â”‚   hip_pos:           -0.5                              â”‚
â”‚   dof_error:         -0.03                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è®­ç»ƒå‘½ä»¤:                                              â”‚
â”‚   python train.py --task=tita2 --headless              â”‚
â”‚ æµ‹è¯•å‘½ä»¤:                                              â”‚
â”‚   python play.py --task=tita2 --load_run=<name>        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**æ–‡æ¡£ç»“æŸ**

*åˆ›å»ºæ—¥æœŸ: 2025å¹´11æœˆ28æ—¥*
*é€‚ç”¨ç‰ˆæœ¬: Tita2 v1.0*